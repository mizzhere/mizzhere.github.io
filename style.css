/* style.css - PHIÊN BẢN NO-SCROLL & VISUAL TIMER */
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

:root {
    --primary-color: #0B57D0;
    --primary-container-color: #D3E3FD;
    --on-primary-container-color: #001B3D;
    --secondary-color: #5C5F62;
    --surface-color: #FEFBFF;
    --surface-container-highest: #E3E3E3;
    --on-surface-color: #1A1C1E;
    --on-surface-variant-color: #42474E;
    --outline-color: #CBD5E1;
    --error-color: #B3261E;
    --success-color: #1A5E20;
    --warning-color: #FBC02D; /* For timer warning */

    --font-family-main: 'Roboto', sans-serif;
    --border-radius-small: 8px;
    --border-radius-medium: 12px;
    --border-radius-large: 16px;
    --elevation-1: 0 1px 2px 0 rgba(0, 0, 0, 0.06), 0 1px 3px 0 rgba(0, 0, 0, 0.04);
    --elevation-2: 0 4px 8px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.05);
    
    /* Biến màu cho vùng số đã có trong root thứ hai, gộp lại */
    --number-area-background: #f8f9fa;
    --number-area-border: #dee2e6;
}

/* Bỏ khối :root bị lặp lại */

html, body {
    height: 100%;
    /* Có thể thử nghiệm với Dynamic Viewport Height Units nếu trình duyệt hỗ trợ
       height: 100dvh;
       Tuy nhiên, để tương thích rộng hơn, ta sẽ xử lý bằng Flexbox và min-height
    */
    margin: 0;
    padding: 0;
    overflow: hidden; /* Giữ nguyên mục tiêu no-scroll tổng thể */
    font-family: var(--font-family-main);
    background-color: #f0f2f5;
    color: var(--on-surface-color);
    box-sizing: border-box;
}
*, *:before, *:after {
    box-sizing: inherit;
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 8px; /* GIẢM PADDING CHO KHÔNG GIAN DỌC */
    min-height: 100%; /* Đảm bảo body chiếm ít nhất full viewport height */
}

#game-container {
    background-color: var(--surface-color);
    padding: 10px; /* GIẢM PADDING */
    border-radius: var(--border-radius-medium); /* Có thể giảm nhẹ */
    box-shadow: var(--elevation-2);
    width: 100%;
    max-width: 700px; /* Giảm nhẹ max-width để không quá rộng trên màn hình ngang nhỏ */
    /* height: calc(100vh - 16px); Thay vì height cố định, dùng flex và min-height */
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Giữ để nội dung bên trong không làm vỡ game-container */
    text-align: center;
    max-height: calc(100vh - 16px); /* GIỚI HẠN CHIỀU CAO TỐI ĐA */
                                    /* 16px là tổng padding của body (8px trên + 8px dưới) */
}

header {
    padding: 8px 0; /* GIẢM */
    border-bottom: 1px solid var(--outline-color);
    margin-bottom: 8px; /* GIẢM */
    flex-shrink: 0;
}
header h1 {
    font-weight: 500;
    font-size: 18px; /* GIẢM FONT SIZE */
    margin: 0;
    line-height: 1.2; /* Đảm bảo không quá cao */
}

.hidden {
    display: none !important;
}

/* --- GAME SCREEN & STRUCTURE --- */
#game-screen {
    flex-grow: 1; /* Cho phép game-screen chiếm không gian còn lại trong game-container */
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Quan trọng: để phase-content-area có thể cuộn nếu cần */
    width: 100%;
    min-height: 0; /* Cần thiết cho flex item để co lại đúng cách khi nội dung lớn */
}

#game-info {
    background-color: var(--primary-container-color);
    color: var(--on-primary-container-color);
    padding: 8px 10px; /* GIẢM */
    border-radius: var(--border-radius-medium);
    margin-bottom: 8px; /* GIẢM */
    display: flex;
    justify-content: space-around; /* Cân đối hơn */
    align-items: center;
    font-weight: 500;
    font-size: 12px; /* GIẢM FONT SIZE */
    flex-shrink: 0;
    gap: 4px; /* Thêm gap nhỏ */
    flex-wrap: wrap; /* Cho phép xuống dòng nếu không đủ chỗ */
}
.info-item { padding: 2px 4px; }
.player-score-display { color: var(--success-color); font-weight: 700; }
.opponent-score-display { color: var(--error-color); font-weight: 700; }
#ingame-restart-btn {
    padding: 5px 8px; /* GIẢM */
    font-size: 11px; /* GIẢM */
    background-color: #E57373; color: white;
    /* margin-left: auto;  Có thể không cần nếu dùng space-around và flex-wrap */
}
/* Nếu muốn nút restart luôn ở cuối hàng khi wrap: */
/* #ingame-restart-btn { margin-left: auto; align-self: center; } */


/* --- FIXED NUMBER DISPLAY AREA --- */
#fixed-number-display-area {
    padding: 10px 8px; /* GIẢM */
    background-color: var(--number-area-background);
    border: 1px solid var(--number-area-border);
    border-radius: var(--border-radius-medium);
    margin-bottom: 8px; /* GIẢM */
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
}
/* Sửa ID cho khớp với JS: #number-context-label */
#number-context-label {
    font-size: 13px; /* GIẢM */
    color: var(--on-surface-variant-color);
    margin-bottom: 5px; /* GIẢM */
    font-weight: 500;
}
#fixed-number-display-area .number-grid {
    margin-top: 0;
    margin-bottom: 0; /* Bỏ margin bottom */
    gap: 8px; /* Giảm gap giữa các cột */
    max-width: 300px; /* Giảm max-width lưới số */
}
#fixed-number-display-area .column-value {
    font-size: 36px; /* Giảm nhẹ kích thước số mặc định, có thể tăng lại cho desktop sau */
    font-weight: 700;
    line-height: 1.1;
}
#fixed-number-display-area .column {
     padding: 8px 6px; /* GIẢM */
     max-width: 80px; /* Giảm max-width cột */
}
#fixed-number-display-area .column-header{
    font-size: 11px; /* GIẢM */
}


/* --- PHASE CONTENT AREA --- */
#phase-content-area {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* QUAN TRỌNG: Cho phép cuộn nội dung phase nếu nó dài hơn vùng chứa */
    position: relative;
    width: 100%;
    min-height: 0; /* Cần thiết cho flex item để co lại đúng cách */
    padding-bottom: 5px; /* Thêm chút padding ở dưới để nội dung không sát đáy khi cuộn */
}

.phase-container {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 5px 0 0 0; /* GIẢM PADDING TOP */
    /* flex-grow: 1; Không đặt ở đây, để main-content-wrapper xử lý */
}
.phase-container h2 {
    font-weight: 500;
    font-size: 16px; /* GIẢM */
    margin-top: 0;
    margin-bottom: 8px; /* GIẢM */
    flex-shrink: 0;
}

.main-content-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-around; /* Giữ nguyên để các element phân bổ */
    width: 100%;
    flex-grow: 1; /* QUAN TRỌNG: Để wrapper này chiếm không gian trong phase-container */
    padding: 0 8px 5px 8px; /* GIẢM PADDING */
    min-height: 100px; /* Đặt chiều cao tối thiểu để tránh co quá nhỏ */
}


/* --- NUMBER GRIDS & COLUMNS (Chung, cho cumulative sums) --- */
.number-grid {
    display: flex;
    justify-content: space-around;
    gap: 10px; /* GIẢM */
    width: 100%;
    max-width: 320px; /* GIẢM */
    margin: 8px 0; /* GIẢM */
    flex-shrink: 0;
}
.column {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex-basis: 0;
    flex-grow: 1;
    max-width: 85px; /* GIẢM */
    padding: 8px 5px; /* GIẢM */
    border-radius: var(--border-radius-medium);
    box-shadow: var(--elevation-1);
    text-align: center;
}
.column-header {
    font-size: 11px; /* GIẢM */
    font-weight: 500; color: var(--on-surface-variant-color);
    margin-bottom: 3px; text-transform: uppercase;
}
.column-value { /* Cho cumulative sums */
    font-size: 26px; /* GIẢM */
    font-weight: 700; color: var(--on-surface-color);
    line-height: 1;
}

.current-numbers .column { background-color: #FFFDE7; border: 1px solid #FFF59D; }
.current-numbers .column-value { color: #F9A825; }

.cumulative-sums-display .column { background-color: #E8F5E9; border: 1px solid #C8E6C9;}
.cumulative-sums-display .column-value { color: #2E7D32; }


/* --- QUESTION & ANSWERS --- */
.info-label {
    font-size: 13px; /* GIẢM */
    color: var(--on-surface-variant-color);
    margin-bottom: 6px; /* GIẢM */
    font-weight: 400;
    flex-shrink: 0;
}
.question-emphasis {
    font-size: 14px; /* GIẢM */
    color: var(--on-surface-color); font-weight: 400;
    margin: 8px auto; /* GIẢM */
    padding: 8px 10px; /* GIẢM */
    background-color: #f7f7f7;
    border-radius: var(--border-radius-medium);
    border-left: 3px solid var(--primary-color);
    max-width: 95%;
    line-height: 1.3;
    flex-shrink: 0;
}
.answer-options {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Luôn 2 cột cho mobile */
    gap: 6px; /* GIẢM */
    margin: 10px 0; /* GIẢM */
    width: 100%;
    max-width: 400px; /* GIẢM */
    flex-shrink: 0;
}
.answer-btn[data-answer="Không có"] {
    grid-column: span 2; /* Nút "Không có" chiếm cả hàng */
}
.answer-btn {
    padding: 10px 8px; /* Điều chỉnh để dễ bấm */
    font-size: 13px; /* GIẢM */
    min-height: 44px; /* Chiều cao tối thiểu dễ bấm */
}
/* ... (styles nút giữ nguyên) ... */


/* --- TIMERS (VISUAL) & RESULT --- */
.timer-display {
    margin-top: 8px; /* GIẢM */
    margin-bottom: 6px; /* GIẢM */
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px; /* GIẢM */
    width: 100%;
    flex-shrink: 0;
}
.timer-text {
    font-size: 11px; /* GIẢM */
    color: var(--on-surface-variant-color);
    font-style: italic; margin: 0;
}
.progress-bar-container {
    width: 50%; max-width: 160px; height: 6px; /* GIẢM */
    /* ... */
}
/* ... (styles progress bar giữ nguyên) ... */


#result-message {
    font-size: 16px; /* GIẢM */
    /* ... */
}
/* ... (styles result message giữ nguyên) ... */


/* --- GAME OVER SCREEN --- */
#game-over-screen {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: var(--surface-color);
    z-index: 20; /* Tăng z-index để chắc chắn ở trên */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px; /* Padding cho nội dung game over */
}
#game-over-screen h2 { font-size: 18px; /* GIẢM */ }
.final-scores { margin: 10px 0; font-size: 14px; /* GIẢM */ }
.final-scores p { margin: 3px 0; }
.final-scores strong { font-size: 15px; /* GIẢM */ padding-left: 4px; color: var(--primary-color); }
#restart-game-btn { padding: 10px 18px; font-size: 14px; /* GIẢM */ }


/* --- RULES DISPLAY --- */
#rules-display {
    margin-top: auto; /* Đẩy xuống dưới cùng */
    text-align: left;
    border-top: 1px solid var(--outline-color);
    padding-top: 8px; /* GIẢM */
    flex-shrink: 0;
    width: 100%; /* Đảm bảo chiếm full width */
}
#rules-display button#toggle-rules-btn {
    font-weight: 400; padding: 7px 10px; font-size: 12px; /* GIẢM */
    width: 100%; /* Nút chiếm hết chiều rộng */
    margin-bottom: 4px; /* Khoảng cách với content */
}
#rules-content {
    background-color: #f9f9fa;
    padding: 8px; /* GIẢM */
    border-radius: var(--border-radius-small); /* Giảm nhẹ */
    max-height: 50px; /* GIỚI HẠN CHIỀU CAO CHO MOBILE */
    overflow-y: auto;
    border: 1px solid var(--outline-color);
    margin-top: 4px; /* GIẢM */
}
#rules-content pre {
    margin: 0; font-family: 'Consolas', 'Monaco', monospace;
    font-size: 9px; /* GIẢM NHIỀU */
    color: var(--on-surface-variant-color);
    line-height: 1.2; white-space: pre-wrap;
}


/* --- BASE BUTTON STYLES --- */
button {
    border: none; padding: 8px 15px; /* GIẢM */
    border-radius: var(--border-radius-medium);
    cursor: pointer; font-size: 14px; /* GIẢM */
    font-weight: 500; margin: 4px 2px; /* GIẢM */
    /* ... */
}
/* ... (styles button variants giữ nguyên) ... */

/* Settings screen button */
#settings-screen {
    /* ... */
    padding: 10px; /* Padding cho settings */
}
#settings-screen h2 { font-size: 20px; /* GIẢM */ margin-bottom: 10px;}
#settings-screen p { font-size: 14px; /* GIẢM */ margin-bottom: 15px;}
#settings-screen button#start-game-btn { padding: 10px 20px; font-size: 15px; /* GIẢM */ }

#proceed-to-questions-btn {
    margin-top: 10px; /* GIẢM */
    padding: 9px 18px; /* GIẢM */
    font-size: 14px; /* GIẢM */
    /* ... */
}

.material-symbols-outlined {
  /* ... */
  font-size: 1.1em; /* Có thể giảm nếu cần */
}

/* --- SETTINGS OPTIONS --- */
.settings-options {
    margin-bottom: 15px; /* GIẢM */
    /* ... */
    gap: 10px; /* GIẢM */
    max-width: 320px; /* GIẢM */
}
.setting-item label {
    font-size: 13px; /* GIẢM */
}
.setting-select {
    padding: 7px 10px; /* GIẢM */
    font-size: 13px; /* GIẢM */
    width: 100%; /* Cho select chiếm full width của item */
}

/* --- HISTORY CONTROLS --- */
#history-controls {
    text-align: center; /* Căn giữa nút lịch sử */
    margin-bottom: 8px; /* GIẢM */
}
#view-history-btn {
    padding: 7px 12px; /* GIẢM */
    font-size: 13px; /* GIẢM */
}

/* --- POPUP STYLES --- */
.popup {
    padding: 10px; /* GIẢM */
}
.popup-content {
    padding: 15px; /* GIẢM */
    max-width: 90%; /* Cho phép rộng hơn trên mobile */
}
.popup-content h2 {
    font-size: 18px; /* GIẢM */
    margin-bottom: 10px; /* GIẢM */
}
.close-popup-btn {
    top: 8px; right: 10px; font-size: 24px;
}
.history-item {
    padding: 6px 3px; /* GIẢM */
    font-size: 13px; /* GIẢM */
}
.history-item .score {
    font-size: 12px; /* GIẢM */
}
.history-item .date {
    font-size: 11px; /* GIẢM */
}
#clear-history-btn {
    /* Style giữ nguyên, nhưng font size nút chung đã giảm */
}

/* Media query cho màn hình rộng hơn (Desktop) để khôi phục/tăng kích thước */
@media (min-width: 768px) { /* Bạn có thể chọn breakpoint khác nếu muốn, vd 601px */
    body {
        padding: 16px;
    }
    #game-container {
        padding: 20px;
        max-width: 780px;
        max-height: calc(100vh - 32px);
    }
    header h1 { font-size: 22px; }
    #game-info { font-size: 14px; padding: 10px 12px; margin-bottom: 10px; flex-wrap: nowrap; }
    .info-item { padding: 2px 6px; }
    #ingame-restart-btn { padding: 6px 10px; font-size: 13px; }

    #fixed-number-display-area { padding: 15px 10px; margin-bottom: 15px; }
    #number-context-label { font-size: 15px; margin-bottom: 10px; }
    #fixed-number-display-area .number-grid { max-width: 400px; gap: 12px; }
    #fixed-number-display-area .column { padding: 12px 10px; max-width: 100px; }
    #fixed-number-display-area .column-header { font-size: 14px; }
    #fixed-number-display-area .column-value { font-size: 52px; /* SỐ TO CHO DESKTOP */ }

    .phase-container h2 { font-size: 18px; margin-bottom: 10px; }
    .main-content-wrapper { padding: 0 10px 10px 10px; min-height: 150px; }

    .number-grid { max-width: 400px; margin: 10px 0; gap: 12px; }
    .column { max-width: 100px; padding: 10px 8px; }
    .column-header { font-size: 14px; margin-bottom: 4px; }
    .column-value { font-size: 32px; } /* Cho cumulative */

    .info-label { font-size: 15px; margin-bottom: 8px; }
    .question-emphasis { font-size: 17px; margin: 10px auto; padding: 10px 15px; border-left-width: 4px; }
    .answer-options { grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 8px; margin: 12px 0; max-width: 550px; }
    .answer-btn[data-answer="Không có"] { grid-column: auto; } /* Reset cho desktop */
    .answer-btn { padding: 10px 12px; font-size: 14px; min-height: auto; }

    .timer-text { font-size: 13px; }
    .progress-bar-container { width: 60%; max-width: 220px; height: 8px; }
    #result-message { font-size: 18px; }

    #game-over-screen h2 { font-size: 22px; }
    .final-scores { margin: 15px 0; font-size: 16px; }
    .final-scores strong { font-size: 18px; }
    #restart-game-btn { padding: 12px 25px; font-size: 17px; }

    #rules-display { padding-top: 10px; }
    #rules-display button#toggle-rules-btn { font-weight: 400; padding: 8px 15px; font-size: 14px; width: auto; margin-bottom: 0; }
    #rules-content { padding: 15px; max-height: 80px; margin-top: 8px; }
    #rules-content pre { font-size: 11px; line-height: 1.4; }

    button { padding: 10px 20px; font-size: 16px; margin: 6px 4px; }
    #settings-screen h2 { font-size: 24px; }
    #settings-screen p { font-size: 16px; }
    #settings-screen button#start-game-btn { padding: 14px 30px; font-size: 18px; }
    #proceed-to-questions-btn { margin-top: 15px; padding: 10px 20px; font-size: 15px; }

    .settings-options { flex-direction: row; justify-content: space-around; gap: 20px; max-width: 600px; margin-bottom: 20px; }
    .setting-select { width: auto; min-width: 150px; font-size: 14px; padding: 8px 12px; }
    .setting-item label { font-size: 14px; }


    #history-controls { text-align: right; margin-bottom: 10px; }
    #view-history-btn { padding: 8px 15px; font-size: 14px; }
    .popup-content { max-width: 500px; padding: 20px; }
    .popup-content h2 { font-size: 20px; margin-bottom: 15px;}
    .history-item { font-size: 14px; }
    .history-item .score { font-size: 13px; }
    .history-item .date { font-size: 12px; }
}
